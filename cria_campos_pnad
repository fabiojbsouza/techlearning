import os
import json

# Dicionário de dados completo
data_dictionary = [
   {"Posição inicial":1,"Tamanho":4,"descrição":"C0001"},
{"Posição inicial":5,"Tamanho":1,"descrição":"C0002"},
{"Posição inicial":6,"Tamanho":2,"descrição":"C0003"},
{"Posição inicial":8,"Tamanho":2,"descrição":"C0004"},
{"Posição inicial":10,"Tamanho":2,"descrição":"C0005"},
{"Posição inicial":12,"Tamanho":9,"descrição":"C0006"},
{"Posição inicial":21,"Tamanho":7,"descrição":"C0007"},
{"Posição inicial":28,"Tamanho":2,"descrição":"C0008"},
{"Posição inicial":30,"Tamanho":2,"descrição":"C0009"},
{"Posição inicial":32,"Tamanho":1,"descrição":"C0010"},
{"Posição inicial":33,"Tamanho":1,"descrição":"C0011"},
{"Posição inicial":34,"Tamanho":1,"descrição":"C0012"},
{"Posição inicial":35,"Tamanho":15,"descrição":"C0013"},
{"Posição inicial":50,"Tamanho":15,"descrição":"C0014"},
{"Posição inicial":65,"Tamanho":9,"descrição":"C0015"},
{"Posição inicial":74,"Tamanho":9,"descrição":"C0016"},
{"Posição inicial":83,"Tamanho":3,"descrição":"C0017"},
{"Posição inicial":86,"Tamanho":3,"descrição":"C0018"},
{"Posição inicial":89,"Tamanho":2,"descrição":"C0019"},
{"Posição inicial":91,"Tamanho":2,"descrição":"C0020"},
{"Posição inicial":93,"Tamanho":2,"descrição":"C0021"},
{"Posição inicial":95,"Tamanho":1,"descrição":"C0022"},
{"Posição inicial":96,"Tamanho":2,"descrição":"C0023"},
{"Posição inicial":98,"Tamanho":2,"descrição":"C0024"},
{"Posição inicial":100,"Tamanho":4,"descrição":"C0025"},
{"Posição inicial":104,"Tamanho":3,"descrição":"C0026"},
{"Posição inicial":107,"Tamanho":1,"descrição":"C0027"},
{"Posição inicial":108,"Tamanho":1,"descrição":"C0028"},
{"Posição inicial":109,"Tamanho":1,"descrição":"C0029"},
{"Posição inicial":110,"Tamanho":1,"descrição":"C0030"},
{"Posição inicial":111,"Tamanho":2,"descrição":"C0031"},
{"Posição inicial":113,"Tamanho":2,"descrição":"C0032"},
{"Posição inicial":115,"Tamanho":1,"descrição":"C0033"},
{"Posição inicial":116,"Tamanho":1,"descrição":"C0034"},
{"Posição inicial":117,"Tamanho":1,"descrição":"C0035"},
{"Posição inicial":118,"Tamanho":2,"descrição":"C0036"},
{"Posição inicial":120,"Tamanho":1,"descrição":"C0037"},
{"Posição inicial":121,"Tamanho":1,"descrição":"C0038"},
{"Posição inicial":122,"Tamanho":1,"descrição":"C0039"},
{"Posição inicial":123,"Tamanho":2,"descrição":"C0040"},
{"Posição inicial":125,"Tamanho":2,"descrição":"C0041"},
{"Posição inicial":127,"Tamanho":1,"descrição":"C0042"},
{"Posição inicial":128,"Tamanho":1,"descrição":"C0043"},
{"Posição inicial":129,"Tamanho":1,"descrição":"C0044"},
{"Posição inicial":130,"Tamanho":1,"descrição":"C0045"},
{"Posição inicial":131,"Tamanho":2,"descrição":"C0046"},
{"Posição inicial":133,"Tamanho":1,"descrição":"C0047"},
{"Posição inicial":134,"Tamanho":1,"descrição":"C0048"},
{"Posição inicial":135,"Tamanho":1,"descrição":"C0049"},
{"Posição inicial":136,"Tamanho":1,"descrição":"C0050"},
{"Posição inicial":137,"Tamanho":1,"descrição":"C0051"},
{"Posição inicial":138,"Tamanho":1,"descrição":"C0052"},
{"Posição inicial":139,"Tamanho":1,"descrição":"C0053"},
{"Posição inicial":140,"Tamanho":1,"descrição":"C0054"},
{"Posição inicial":141,"Tamanho":1,"descrição":"C0055"},
{"Posição inicial":142,"Tamanho":1,"descrição":"C0056"},
{"Posição inicial":143,"Tamanho":1,"descrição":"C0057"},
{"Posição inicial":144,"Tamanho":1,"descrição":"C0058"},
{"Posição inicial":145,"Tamanho":2,"descrição":"C0059"},
{"Posição inicial":147,"Tamanho":2,"descrição":"C0060"},
{"Posição inicial":149,"Tamanho":2,"descrição":"C0061"},
{"Posição inicial":151,"Tamanho":1,"descrição":"C0062"},
{"Posição inicial":152,"Tamanho":4,"descrição":"C0063"},
{"Posição inicial":156,"Tamanho":1,"descrição":"C0064"},
{"Posição inicial":157,"Tamanho":1,"descrição":"C0065"},
{"Posição inicial":158,"Tamanho":5,"descrição":"C0066"},
{"Posição inicial":163,"Tamanho":1,"descrição":"C0067"},
{"Posição inicial":164,"Tamanho":1,"descrição":"C0068"},
{"Posição inicial":165,"Tamanho":1,"descrição":"C0069"},
{"Posição inicial":166,"Tamanho":1,"descrição":"C0070"},
{"Posição inicial":167,"Tamanho":1,"descrição":"C0071"},
{"Posição inicial":168,"Tamanho":1,"descrição":"C0072"},
{"Posição inicial":169,"Tamanho":2,"descrição":"C0073"},
{"Posição inicial":171,"Tamanho":1,"descrição":"C0074"},
{"Posição inicial":172,"Tamanho":1,"descrição":"C0075"},
{"Posição inicial":173,"Tamanho":2,"descrição":"C0076"},
{"Posição inicial":175,"Tamanho":2,"descrição":"C0077"},
{"Posição inicial":177,"Tamanho":1,"descrição":"C0078"},
{"Posição inicial":178,"Tamanho":1,"descrição":"C0079"},
{"Posição inicial":179,"Tamanho":1,"descrição":"C0080"},
{"Posição inicial":180,"Tamanho":1,"descrição":"C0081"},
{"Posição inicial":181,"Tamanho":1,"descrição":"C0082"},
{"Posição inicial":182,"Tamanho":2,"descrição":"C0083"},
{"Posição inicial":184,"Tamanho":2,"descrição":"C0084"},
{"Posição inicial":186,"Tamanho":1,"descrição":"C0085"},
{"Posição inicial":187,"Tamanho":1,"descrição":"C0086"},
{"Posição inicial":188,"Tamanho":1,"descrição":"C0087"},
{"Posição inicial":189,"Tamanho":1,"descrição":"C0088"},
{"Posição inicial":190,"Tamanho":1,"descrição":"C0089"},
{"Posição inicial":191,"Tamanho":1,"descrição":"C0090"},
{"Posição inicial":192,"Tamanho":1,"descrição":"C0091"},
{"Posição inicial":193,"Tamanho":1,"descrição":"C0092"},
{"Posição inicial":194,"Tamanho":1,"descrição":"C0093"},
{"Posição inicial":195,"Tamanho":1,"descrição":"C0094"},
{"Posição inicial":196,"Tamanho":1,"descrição":"C0095"},
{"Posição inicial":197,"Tamanho":1,"descrição":"C0096"},
{"Posição inicial":198,"Tamanho":1,"descrição":"C0097"},
{"Posição inicial":199,"Tamanho":1,"descrição":"C0098"},
{"Posição inicial":200,"Tamanho":8,"descrição":"C0099"},
{"Posição inicial":208,"Tamanho":1,"descrição":"C0100"},
{"Posição inicial":209,"Tamanho":1,"descrição":"C0101"},
{"Posição inicial":210,"Tamanho":8,"descrição":"C0102"},
{"Posição inicial":218,"Tamanho":1,"descrição":"C0103"},
{"Posição inicial":219,"Tamanho":1,"descrição":"C0104"},
{"Posição inicial":220,"Tamanho":1,"descrição":"C0105"},
{"Posição inicial":221,"Tamanho":1,"descrição":"C0106"},
{"Posição inicial":222,"Tamanho":1,"descrição":"C0107"},
{"Posição inicial":223,"Tamanho":8,"descrição":"C0108"},
{"Posição inicial":231,"Tamanho":1,"descrição":"C0109"},
{"Posição inicial":232,"Tamanho":1,"descrição":"C0110"},
{"Posição inicial":233,"Tamanho":8,"descrição":"C0111"},
{"Posição inicial":241,"Tamanho":3,"descrição":"C0112"},
{"Posição inicial":244,"Tamanho":3,"descrição":"C0113"},
{"Posição inicial":247,"Tamanho":1,"descrição":"C0114"},
{"Posição inicial":248,"Tamanho":2,"descrição":"C0115"},
{"Posição inicial":250,"Tamanho":2,"descrição":"C0116"},
{"Posição inicial":252,"Tamanho":2,"descrição":"C0117"},
{"Posição inicial":254,"Tamanho":4,"descrição":"C0118"},
{"Posição inicial":258,"Tamanho":1,"descrição":"C0119"},
{"Posição inicial":259,"Tamanho":1,"descrição":"C0120"},
{"Posição inicial":260,"Tamanho":5,"descrição":"C0121"},
{"Posição inicial":265,"Tamanho":1,"descrição":"C0122"},
{"Posição inicial":266,"Tamanho":1,"descrição":"C0123"},
{"Posição inicial":267,"Tamanho":1,"descrição":"C0124"},
{"Posição inicial":268,"Tamanho":1,"descrição":"C0125"},
{"Posição inicial":269,"Tamanho":1,"descrição":"C0126"},
{"Posição inicial":270,"Tamanho":1,"descrição":"C0127"},
{"Posição inicial":271,"Tamanho":1,"descrição":"C0128"},
{"Posição inicial":272,"Tamanho":1,"descrição":"C0129"},
{"Posição inicial":273,"Tamanho":8,"descrição":"C0130"},
{"Posição inicial":281,"Tamanho":1,"descrição":"C0131"},
{"Posição inicial":282,"Tamanho":1,"descrição":"C0132"},
{"Posição inicial":283,"Tamanho":8,"descrição":"C0133"},
{"Posição inicial":291,"Tamanho":1,"descrição":"C0134"},
{"Posição inicial":292,"Tamanho":1,"descrição":"C0135"},
{"Posição inicial":293,"Tamanho":1,"descrição":"C0136"},
{"Posição inicial":294,"Tamanho":1,"descrição":"C0137"},
{"Posição inicial":295,"Tamanho":1,"descrição":"C0138"},
{"Posição inicial":296,"Tamanho":8,"descrição":"C0139"},
{"Posição inicial":304,"Tamanho":1,"descrição":"C0140"},
{"Posição inicial":305,"Tamanho":1,"descrição":"C0141"},
{"Posição inicial":306,"Tamanho":8,"descrição":"C0142"},
{"Posição inicial":314,"Tamanho":3,"descrição":"C0143"},
{"Posição inicial":317,"Tamanho":3,"descrição":"C0144"},
{"Posição inicial":320,"Tamanho":1,"descrição":"C0145"},
{"Posição inicial":321,"Tamanho":1,"descrição":"C0146"},
{"Posição inicial":322,"Tamanho":1,"descrição":"C0147"},
{"Posição inicial":323,"Tamanho":1,"descrição":"C0148"},
{"Posição inicial":324,"Tamanho":8,"descrição":"C0149"},
{"Posição inicial":332,"Tamanho":1,"descrição":"C0150"},
{"Posição inicial":333,"Tamanho":1,"descrição":"C0151"},
{"Posição inicial":334,"Tamanho":8,"descrição":"C0152"},
{"Posição inicial":342,"Tamanho":1,"descrição":"C0153"},
{"Posição inicial":343,"Tamanho":1,"descrição":"C0154"},
{"Posição inicial":344,"Tamanho":1,"descrição":"C0155"},
{"Posição inicial":345,"Tamanho":1,"descrição":"C0156"},
{"Posição inicial":346,"Tamanho":1,"descrição":"C0157"},
{"Posição inicial":347,"Tamanho":1,"descrição":"C0158"},
{"Posição inicial":348,"Tamanho":8,"descrição":"C0159"},
{"Posição inicial":356,"Tamanho":1,"descrição":"C0160"},
{"Posição inicial":357,"Tamanho":1,"descrição":"C0161"},
{"Posição inicial":358,"Tamanho":8,"descrição":"C0162"},
{"Posição inicial":366,"Tamanho":3,"descrição":"C0163"},
{"Posição inicial":369,"Tamanho":3,"descrição":"C0164"},
{"Posição inicial":372,"Tamanho":1,"descrição":"C0165"},
{"Posição inicial":373,"Tamanho":1,"descrição":"C0166"},
{"Posição inicial":374,"Tamanho":1,"descrição":"C0167"},
{"Posição inicial":375,"Tamanho":1,"descrição":"C0168"},
{"Posição inicial":376,"Tamanho":1,"descrição":"C0169"},
{"Posição inicial":377,"Tamanho":2,"descrição":"C0170"},
{"Posição inicial":379,"Tamanho":1,"descrição":"C0171"},
{"Posição inicial":380,"Tamanho":1,"descrição":"C0172"},
{"Posição inicial":381,"Tamanho":1,"descrição":"C0173"},
{"Posição inicial":382,"Tamanho":2,"descrição":"C0174"},
{"Posição inicial":384,"Tamanho":1,"descrição":"C0175"},
{"Posição inicial":385,"Tamanho":2,"descrição":"C0176"},
{"Posição inicial":387,"Tamanho":1,"descrição":"C0177"},
{"Posição inicial":388,"Tamanho":2,"descrição":"C0178"},
{"Posição inicial":390,"Tamanho":2,"descrição":"C0179"},
{"Posição inicial":392,"Tamanho":2,"descrição":"C0180"},
{"Posição inicial":394,"Tamanho":1,"descrição":"C0181"},
{"Posição inicial":395,"Tamanho":1,"descrição":"C0182"},
{"Posição inicial":396,"Tamanho":1,"descrição":"C0183"},
{"Posição inicial":397,"Tamanho":1,"descrição":"C0184"},
{"Posição inicial":398,"Tamanho":2,"descrição":"C0185"},
{"Posição inicial":400,"Tamanho":2,"descrição":"C0186"},
{"Posição inicial":402,"Tamanho":1,"descrição":"C0187"},
{"Posição inicial":403,"Tamanho":2,"descrição":"C0188"},
{"Posição inicial":405,"Tamanho":1,"descrição":"C0189"},
{"Posição inicial":406,"Tamanho":2,"descrição":"C0190"},
{"Posição inicial":408,"Tamanho":1,"descrição":"C0191"},
{"Posição inicial":409,"Tamanho":1,"descrição":"C0192"},
{"Posição inicial":410,"Tamanho":1,"descrição":"C0193"},
{"Posição inicial":411,"Tamanho":1,"descrição":"C0194"},
{"Posição inicial":412,"Tamanho":1,"descrição":"C0195"},
{"Posição inicial":413,"Tamanho":1,"descrição":"C0196"},
{"Posição inicial":414,"Tamanho":1,"descrição":"C0197"},
{"Posição inicial":415,"Tamanho":1,"descrição":"C0198"},
{"Posição inicial":416,"Tamanho":1,"descrição":"C0199"},
{"Posição inicial":417,"Tamanho":2,"descrição":"C0200"},
{"Posição inicial":419,"Tamanho":2,"descrição":"C0201"},
{"Posição inicial":421,"Tamanho":2,"descrição":"C0202"},
{"Posição inicial":423,"Tamanho":1,"descrição":"C0203"},
{"Posição inicial":424,"Tamanho":1,"descrição":"C0204"},
{"Posição inicial":425,"Tamanho":1,"descrição":"C0205"},
{"Posição inicial":426,"Tamanho":1,"descrição":"C0206"},
{"Posição inicial":427,"Tamanho":8,"descrição":"C0207"},
{"Posição inicial":435,"Tamanho":8,"descrição":"C0208"},
{"Posição inicial":443,"Tamanho":1,"descrição":"C0209"},
{"Posição inicial":444,"Tamanho":8,"descrição":"C0210"},
{"Posição inicial":452,"Tamanho":8,"descrição":"C0211"},
{"Posição inicial":460,"Tamanho":1,"descrição":"C0212"},
{"Posição inicial":461,"Tamanho":1,"descrição":"C0213"},
{"Posição inicial":462,"Tamanho":3,"descrição":"C0214"},
{"Posição inicial":465,"Tamanho":3,"descrição":"C0215"},
{"Posição inicial":468,"Tamanho":3,"descrição":"C0216"},
{"Posição inicial":471,"Tamanho":3,"descrição":"C0217"},
{"Posição inicial":474,"Tamanho":3,"descrição":"C0218"},
{"Posição inicial":477,"Tamanho":1,"descrição":"C0219"},
{"Posição inicial":478,"Tamanho":1,"descrição":"C0220"},
{"Posição inicial":479,"Tamanho":15,"descrição":"C0221"},
{"Posição inicial":494,"Tamanho":15,"descrição":"C0222"},
{"Posição inicial":509,"Tamanho":15,"descrição":"C0223"},
{"Posição inicial":524,"Tamanho":15,"descrição":"C0224"},
{"Posição inicial":539,"Tamanho":15,"descrição":"C0225"},
{"Posição inicial":554,"Tamanho":15,"descrição":"C0226"},
{"Posição inicial":569,"Tamanho":15,"descrição":"C0227"},
{"Posição inicial":584,"Tamanho":15,"descrição":"C0228"},
{"Posição inicial":599,"Tamanho":15,"descrição":"C0229"},
{"Posição inicial":614,"Tamanho":15,"descrição":"C0230"},
{"Posição inicial":629,"Tamanho":15,"descrição":"C0231"},
{"Posição inicial":644,"Tamanho":15,"descrição":"C0232"},
{"Posição inicial":659,"Tamanho":15,"descrição":"C0233"},
{"Posição inicial":674,"Tamanho":15,"descrição":"C0234"},
{"Posição inicial":689,"Tamanho":15,"descrição":"C0235"},
{"Posição inicial":704,"Tamanho":15,"descrição":"C0236"},
{"Posição inicial":719,"Tamanho":15,"descrição":"C0237"},
{"Posição inicial":734,"Tamanho":15,"descrição":"C0238"},
{"Posição inicial":749,"Tamanho":15,"descrição":"C0239"},
{"Posição inicial":764,"Tamanho":15,"descrição":"C0240"},
{"Posição inicial":779,"Tamanho":15,"descrição":"C0241"},
{"Posição inicial":794,"Tamanho":15,"descrição":"C0242"},
{"Posição inicial":809,"Tamanho":15,"descrição":"C0243"},
{"Posição inicial":824,"Tamanho":15,"descrição":"C0244"},
{"Posição inicial":839,"Tamanho":15,"descrição":"C0245"},
{"Posição inicial":854,"Tamanho":15,"descrição":"C0246"},
{"Posição inicial":869,"Tamanho":15,"descrição":"C0247"},
{"Posição inicial":884,"Tamanho":15,"descrição":"C0248"},
{"Posição inicial":899,"Tamanho":15,"descrição":"C0249"},
{"Posição inicial":914,"Tamanho":15,"descrição":"C0250"},
{"Posição inicial":929,"Tamanho":15,"descrição":"C0251"},
{"Posição inicial":944,"Tamanho":15,"descrição":"C0252"},
{"Posição inicial":959,"Tamanho":15,"descrição":"C0253"},
{"Posição inicial":974,"Tamanho":15,"descrição":"C0254"},
{"Posição inicial":989,"Tamanho":15,"descrição":"C0255"},
{"Posição inicial":1004,"Tamanho":15,"descrição":"C0256"},
{"Posição inicial":1019,"Tamanho":15,"descrição":"C0257"},
{"Posição inicial":1034,"Tamanho":15,"descrição":"C0258"},
{"Posição inicial":1049,"Tamanho":15,"descrição":"C0259"},
{"Posição inicial":1064,"Tamanho":15,"descrição":"C0260"},
{"Posição inicial":1079,"Tamanho":15,"descrição":"C0261"},
{"Posição inicial":1094,"Tamanho":15,"descrição":"C0262"},
{"Posição inicial":1109,"Tamanho":15,"descrição":"C0263"},
{"Posição inicial":1124,"Tamanho":15,"descrição":"C0264"},
{"Posição inicial":1139,"Tamanho":15,"descrição":"C0265"},
{"Posição inicial":1154,"Tamanho":15,"descrição":"C0266"},
{"Posição inicial":1169,"Tamanho":15,"descrição":"C0267"},
{"Posição inicial":1184,"Tamanho":15,"descrição":"C0268"},
{"Posição inicial":1199,"Tamanho":15,"descrição":"C0269"},
{"Posição inicial":1214,"Tamanho":15,"descrição":"C0270"},
{"Posição inicial":1229,"Tamanho":15,"descrição":"C0271"},
{"Posição inicial":1244,"Tamanho":15,"descrição":"C0272"},
{"Posição inicial":1259,"Tamanho":15,"descrição":"C0273"},
{"Posição inicial":1274,"Tamanho":15,"descrição":"C0274"},
{"Posição inicial":1289,"Tamanho":15,"descrição":"C0275"},
{"Posição inicial":1304,"Tamanho":15,"descrição":"C0276"},
{"Posição inicial":1319,"Tamanho":15,"descrição":"C0277"},
{"Posição inicial":1334,"Tamanho":15,"descrição":"C0278"},
{"Posição inicial":1349,"Tamanho":15,"descrição":"C0279"},
{"Posição inicial":1364,"Tamanho":15,"descrição":"C0280"},
{"Posição inicial":1379,"Tamanho":15,"descrição":"C0281"},
{"Posição inicial":1394,"Tamanho":15,"descrição":"C0282"},
{"Posição inicial":1409,"Tamanho":15,"descrição":"C0283"},
{"Posição inicial":1424,"Tamanho":15,"descrição":"C0284"},
{"Posição inicial":1439,"Tamanho":15,"descrição":"C0285"},
{"Posição inicial":1454,"Tamanho":15,"descrição":"C0286"},
{"Posição inicial":1469,"Tamanho":15,"descrição":"C0287"},
{"Posição inicial":1484,"Tamanho":15,"descrição":"C0288"},
{"Posição inicial":1499,"Tamanho":15,"descrição":"C0289"},
{"Posição inicial":1514,"Tamanho":15,"descrição":"C0290"},
{"Posição inicial":1529,"Tamanho":15,"descrição":"C0291"},
{"Posição inicial":1544,"Tamanho":15,"descrição":"C0292"},
{"Posição inicial":1559,"Tamanho":15,"descrição":"C0293"},
{"Posição inicial":1574,"Tamanho":15,"descrição":"C0294"},
{"Posição inicial":1589,"Tamanho":15,"descrição":"C0295"},
{"Posição inicial":1604,"Tamanho":15,"descrição":"C0296"},
{"Posição inicial":1619,"Tamanho":15,"descrição":"C0297"},
{"Posição inicial":1634,"Tamanho":15,"descrição":"C0298"},
{"Posição inicial":1649,"Tamanho":15,"descrição":"C0299"},
{"Posição inicial":1664,"Tamanho":15,"descrição":"C0300"},
{"Posição inicial":1679,"Tamanho":15,"descrição":"C0301"},
{"Posição inicial":1694,"Tamanho":15,"descrição":"C0302"},
{"Posição inicial":1709,"Tamanho":15,"descrição":"C0303"},
{"Posição inicial":1724,"Tamanho":15,"descrição":"C0304"},
{"Posição inicial":1739,"Tamanho":15,"descrição":"C0305"},
{"Posição inicial":1754,"Tamanho":15,"descrição":"C0306"},
{"Posição inicial":1769,"Tamanho":15,"descrição":"C0307"},
{"Posição inicial":1784,"Tamanho":15,"descrição":"C0308"},
{"Posição inicial":1799,"Tamanho":15,"descrição":"C0309"},
{"Posição inicial":1814,"Tamanho":15,"descrição":"C0310"},
{"Posição inicial":1829,"Tamanho":15,"descrição":"C0311"},
{"Posição inicial":1844,"Tamanho":15,"descrição":"C0312"},
{"Posição inicial":1859,"Tamanho":15,"descrição":"C0313"},
{"Posição inicial":1874,"Tamanho":15,"descrição":"C0314"},
{"Posição inicial":1889,"Tamanho":15,"descrição":"C0315"},
{"Posição inicial":1904,"Tamanho":15,"descrição":"C0316"},
{"Posição inicial":1919,"Tamanho":15,"descrição":"C0317"},
{"Posição inicial":1934,"Tamanho":15,"descrição":"C0318"},
{"Posição inicial":1949,"Tamanho":15,"descrição":"C0319"},
{"Posição inicial":1964,"Tamanho":15,"descrição":"C0320"},
{"Posição inicial":1979,"Tamanho":15,"descrição":"C0321"},
{"Posição inicial":1994,"Tamanho":15,"descrição":"C0322"},
{"Posição inicial":2009,"Tamanho":15,"descrição":"C0323"},
{"Posição inicial":2024,"Tamanho":15,"descrição":"C0324"},
{"Posição inicial":2039,"Tamanho":15,"descrição":"C0325"},
{"Posição inicial":2054,"Tamanho":15,"descrição":"C0326"},
{"Posição inicial":2069,"Tamanho":15,"descrição":"C0327"},
{"Posição inicial":2084,"Tamanho":15,"descrição":"C0328"},
{"Posição inicial":2099,"Tamanho":15,"descrição":"C0329"},
{"Posição inicial":2114,"Tamanho":15,"descrição":"C0330"},
{"Posição inicial":2129,"Tamanho":15,"descrição":"C0331"},
{"Posição inicial":2144,"Tamanho":15,"descrição":"C0332"},
{"Posição inicial":2159,"Tamanho":15,"descrição":"C0333"},
{"Posição inicial":2174,"Tamanho":15,"descrição":"C0334"},
{"Posição inicial":2189,"Tamanho":15,"descrição":"C0335"},
{"Posição inicial":2204,"Tamanho":15,"descrição":"C0336"},
{"Posição inicial":2219,"Tamanho":15,"descrição":"C0337"},
{"Posição inicial":2234,"Tamanho":15,"descrição":"C0338"},
{"Posição inicial":2249,"Tamanho":15,"descrição":"C0339"},
{"Posição inicial":2264,"Tamanho":15,"descrição":"C0340"},
{"Posição inicial":2279,"Tamanho":15,"descrição":"C0341"},
{"Posição inicial":2294,"Tamanho":15,"descrição":"C0342"},
{"Posição inicial":2309,"Tamanho":15,"descrição":"C0343"},
{"Posição inicial":2324,"Tamanho":15,"descrição":"C0344"},
{"Posição inicial":2339,"Tamanho":15,"descrição":"C0345"},
{"Posição inicial":2354,"Tamanho":15,"descrição":"C0346"},
{"Posição inicial":2369,"Tamanho":15,"descrição":"C0347"},
{"Posição inicial":2384,"Tamanho":15,"descrição":"C0348"},
{"Posição inicial":2399,"Tamanho":15,"descrição":"C0349"},
{"Posição inicial":2414,"Tamanho":15,"descrição":"C0350"},
{"Posição inicial":2429,"Tamanho":15,"descrição":"C0351"},
{"Posição inicial":2444,"Tamanho":15,"descrição":"C0352"},
{"Posição inicial":2459,"Tamanho":15,"descrição":"C0353"},
{"Posição inicial":2474,"Tamanho":15,"descrição":"C0354"},
{"Posição inicial":2489,"Tamanho":15,"descrição":"C0355"},
{"Posição inicial":2504,"Tamanho":15,"descrição":"C0356"},
{"Posição inicial":2519,"Tamanho":15,"descrição":"C0357"},
{"Posição inicial":2534,"Tamanho":15,"descrição":"C0358"},
{"Posição inicial":2549,"Tamanho":15,"descrição":"C0359"},
{"Posição inicial":2564,"Tamanho":15,"descrição":"C0360"},
{"Posição inicial":2579,"Tamanho":15,"descrição":"C0361"},
{"Posição inicial":2594,"Tamanho":15,"descrição":"C0362"},
{"Posição inicial":2609,"Tamanho":15,"descrição":"C0363"},
{"Posição inicial":2624,"Tamanho":15,"descrição":"C0364"},
{"Posição inicial":2639,"Tamanho":15,"descrição":"C0365"},
{"Posição inicial":2654,"Tamanho":15,"descrição":"C0366"},
{"Posição inicial":2669,"Tamanho":15,"descrição":"C0367"},
{"Posição inicial":2684,"Tamanho":15,"descrição":"C0368"},
{"Posição inicial":2699,"Tamanho":15,"descrição":"C0369"},
{"Posição inicial":2714,"Tamanho":15,"descrição":"C0370"},
{"Posição inicial":2729,"Tamanho":15,"descrição":"C0371"},
{"Posição inicial":2744,"Tamanho":15,"descrição":"C0372"},
{"Posição inicial":2759,"Tamanho":15,"descrição":"C0373"},
{"Posição inicial":2774,"Tamanho":15,"descrição":"C0374"},
{"Posição inicial":2789,"Tamanho":15,"descrição":"C0375"},
{"Posição inicial":2804,"Tamanho":15,"descrição":"C0376"},
{"Posição inicial":2819,"Tamanho":15,"descrição":"C0377"},
{"Posição inicial":2834,"Tamanho":15,"descrição":"C0378"},
{"Posição inicial":2849,"Tamanho":15,"descrição":"C0379"},
{"Posição inicial":2864,"Tamanho":15,"descrição":"C0380"},
{"Posição inicial":2879,"Tamanho":15,"descrição":"C0381"},
{"Posição inicial":2894,"Tamanho":15,"descrição":"C0382"},
{"Posição inicial":2909,"Tamanho":15,"descrição":"C0383"},
{"Posição inicial":2924,"Tamanho":15,"descrição":"C0384"},
{"Posição inicial":2939,"Tamanho":15,"descrição":"C0385"},
{"Posição inicial":2954,"Tamanho":15,"descrição":"C0386"},
{"Posição inicial":2969,"Tamanho":15,"descrição":"C0387"},
{"Posição inicial":2984,"Tamanho":15,"descrição":"C0388"},
{"Posição inicial":2999,"Tamanho":15,"descrição":"C0389"},
{"Posição inicial":3014,"Tamanho":15,"descrição":"C0390"},
{"Posição inicial":3029,"Tamanho":15,"descrição":"C0391"},
{"Posição inicial":3044,"Tamanho":15,"descrição":"C0392"},
{"Posição inicial":3059,"Tamanho":15,"descrição":"C0393"},
{"Posição inicial":3074,"Tamanho":15,"descrição":"C0394"},
{"Posição inicial":3089,"Tamanho":15,"descrição":"C0395"},
{"Posição inicial":3104,"Tamanho":15,"descrição":"C0396"},
{"Posição inicial":3119,"Tamanho":15,"descrição":"C0397"},
{"Posição inicial":3134,"Tamanho":15,"descrição":"C0398"},
{"Posição inicial":3149,"Tamanho":15,"descrição":"C0399"},
{"Posição inicial":3164,"Tamanho":15,"descrição":"C0400"},
{"Posição inicial":3179,"Tamanho":15,"descrição":"C0401"},
{"Posição inicial":3194,"Tamanho":15,"descrição":"C0402"},
{"Posição inicial":3209,"Tamanho":15,"descrição":"C0403"},
{"Posição inicial":3224,"Tamanho":15,"descrição":"C0404"},
{"Posição inicial":3239,"Tamanho":15,"descrição":"C0405"},
{"Posição inicial":3254,"Tamanho":15,"descrição":"C0406"},
{"Posição inicial":3269,"Tamanho":15,"descrição":"C0407"},
{"Posição inicial":3284,"Tamanho":15,"descrição":"C0408"},
{"Posição inicial":3299,"Tamanho":15,"descrição":"C0409"},
{"Posição inicial":3314,"Tamanho":15,"descrição":"C0410"},
{"Posição inicial":3329,"Tamanho":15,"descrição":"C0411"},
{"Posição inicial":3344,"Tamanho":15,"descrição":"C0412"},
{"Posição inicial":3359,"Tamanho":15,"descrição":"C0413"},
{"Posição inicial":3374,"Tamanho":15,"descrição":"C0414"},
{"Posição inicial":3389,"Tamanho":15,"descrição":"C0415"},
{"Posição inicial":3404,"Tamanho":15,"descrição":"C0416"},
{"Posição inicial":3419,"Tamanho":15,"descrição":"C0417"},
{"Posição inicial":3434,"Tamanho":15,"descrição":"C0418"},
{"Posição inicial":3449,"Tamanho":15,"descrição":"C0419"},
{"Posição inicial":3464,"Tamanho":15,"descrição":"C0420"},
]

def extract_fields_to_dict(data_fragment, data_dict):
    """Extract fields from a data fragment based on the data dictionary and return as a dictionary."""
    extracted_fields = {}
    for field in data_dict:
        start_pos = field['Posição inicial'] - 1  # Convert to 0-based index
        length = field['Tamanho']
        field_name = field['descrição']
        extracted_fields[field_name] = data_fragment[start_pos:start_pos + length].strip()
    return extracted_fields

def process_files_in_directory(directory_path, data_dict, output_json_path, batch_size=10000):
    """Process all .txt files in the given directory, extract fields, and save to a single JSON file in batches."""
    with open(output_json_path, 'w', encoding='utf-8') as json_file:
        json_file.write("[\n")  # Begin the JSON array
        first_item = True
        batch_count = 0

        for filename in os.listdir(directory_path):
            if filename.endswith(".txt"):
                file_path = os.path.join(directory_path, filename)
                with open(file_path, 'r', encoding='utf-8') as file:
                    for line in file:
                        extracted_data = extract_fields_to_dict(line, data_dict)
                        if not first_item:
                            json_file.write(",\n")
                        json.dump(extracted_data, json_file, ensure_ascii=False, indent=4)
                        first_item = False

                        batch_count += 1
                        if batch_count >= batch_size:
                            json_file.flush()
                            batch_count = 0

        json_file.write("\n]")  # End the JSON array

    print(f"Dados processados e salvos em {output_json_path}")

# Caminho para o diretório contendo os arquivos de texto
directory_path = r'C:\Users\fabio\OneDrive - R5Co - Projetos\Bases_de_Dados'

# Caminho para salvar o arquivo JSON
output_json_path = r'C:\Users\fabio\OneDrive - R5Co - Projetos\Bases_de_Dados\output_data.json'

# Processar os arquivos e salvar os dados no arquivo JSON
process_files_in_directory(directory_path, data_dictionary, output_json_path)

print(f"Dados processados e salvos em {output_json_path}")
